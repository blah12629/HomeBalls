@inherits HomeBallsLoggingComponent
@inject IHomeBallsAppSettings Settings
@inject IHomeBallsLoadableDataSource Data

@foreach (var id in BallIds)
{
    <HomeBallsEntryHeaderCell BallId="@id"></HomeBallsEntryHeaderCell>
}

@code {
    protected IReadOnlyCollection<UInt16> BallIds { get; set; } =
        new List<UInt16> { }.AsReadOnly();

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        Data.Items.DataLoaded += OnBallsLoaded;
        Data.Pokeballs.DataLoaded += OnBallsLoaded;
    }

    protected virtual void OnBallsLoaded(
        Object? sender,
        TimedActionEndedEventArgs e)
    {
        var data = Data.Items.IsLoaded ? Data.Items :
            Data.Pokeballs.IsLoaded ? Data.Pokeballs :
            default;

        if (data == default) return;
        BallIds = data.Select(ball => ball.Id).ToList().AsReadOnly();
        StateHasChanged();
    }
}